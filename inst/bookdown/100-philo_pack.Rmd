# Philosophy of PPBstats {#philo}

This chapter describes what is participatory plant breeding, the objectives of `PPBstats`, the analysis according to the objectives and how to install `PPBstats`.


## What is Participatory Plant Bredding ?

- **decentralize the selection**

When decentralizing the selection in target environment [@desclaux_changes_2008], the phenotypic trait is the sum of genetic ($G$), environmental ($E$) and interaction between the two ($G \times E$) : $P = G + E + G \times E$.
Broad sens heritability of a given trait is then: 

$h^2_{sl} = \frac{var(G)}{var(G) + var(E) + var(G\times E)}$

Heritability taking into account the network is therefore inferior or equal to heritability on a given site because $var(G\times E) > 0$.
When facing a wide diversity of agroecological environment and practices, decentralized breeding is a key point to select adapted varieties to local agro-systems.

- **involve all actors in the breeding decision process**: farmers, technicians, researchers, facilitators, consumers ... Such involvements empower all actors and answer the real needs of actors  [@sperling_framework_2001].


## Objectives of `PPBstats`

`PPBstats` aims to perform analysis found within PPB programmes at four levels:

- network of seeds circulation (section \@ref(network))

- agronomic trials (section \@ref(agronomic)) in order to set, describe and analyse balanced and unbalanced trials in decentralized participatory plant breeding programmes.
Nutritional data are also dealt here as it is the same data structure as agronomic data.
The statistical procedures are based on frequentist and bayesian approaches.

- organoleptic tests (section \@ref(organoleptic))

- molecular experiments (section \@ref(molecular))

Please, feel free to contribute to other aspects of analysis, see section \@ref(contributions) for more information.


## Analysis according to the objectives

Note that nutritional analysis are under the agronomic analysis as it is the same type of experimental design and data.

Five main objectives dealing with PPB programmes can be :

- **Study network of seed circulation** to have insight on how exchanges are structured through network analysis (section \@ref(network)).

- **Improve the prediction of a target variable for selection**: this refers to non parametric and multivariate analysis, regression, classificationand regression trees, random forest.
It can be done on agronomic or nutritional data.
Only multivariate analyses are proposed in `PPBstats` in section \@ref(multivariate-analysis).

- **Compare different germplasms on each location for selection**.
This can be done through 
     - agronomic analysis within family 1 of analysis (section \@ref(family-1))
         - classic anova (section \@ref(classic-anova))
         - spatial model (section \@ref(spatial-analysis))
         - bayesian hierarchical model (section \@ref(model-1))
     - organoleptic analysis (section \@ref(organoleptic))
Based on these analysis, specific objective including response to selection analysis can also be done.

- **Study response of germplasm over several locations for selection**.
This can be done through agronomic analysis within family 2 of analysis (section \@ref(family-2)):
    - incomplete block design (section \@ref(ibd))
    - AMMI (section \@ref(ammi))
    - GGE (section \@ref(gge))
    - bayesian hierarchical model (section \@ref(model-2))
    - migrant-residant (section) \@ref(migrant-residant))
For the latest, it corresponds to a specific objective : study migrant and residant effect, where migrant in a location refers to a germplasm that has not been grown or selected in a given location and resident in a location refers to a germplasm that has been grown or selected in a given location.

- **Study diversity structure and identify complementary or similar parents for cross**.
This can be done through 
    - agronomic :
        - multivariate and clustering analysis mentionned in section \@ref(multivariate-analysis) as well as outputs from other models where germplasm effects are estimated and used in a post-hoc analysis (AMMI (section \@ref(ammi)), GGE (section \@ref(gge)) and bayesian model (section \@ref(model-2))).
    - molecular analysis (section \@ref(molecular))

For each objective and analysis, different experimental design are possible based on number of plots per location, the number of location, the replication of germplasm within and between locations (section \@ref(doe)).
Each of these objective is explained throught exemple for each analyse in its corresponding section.

Figure \@ref(fig:tree-all-analysis) presents a decision tree with all objectives and analysis carry out in `PPBstats`.
Each branch is explained throught exemple for each experimental design and analyse in its corresponding section.

```{r tree-all-analysis, out.width='100%', fig.align='center', echo=FALSE, fig.cap="Decision tree with all objectives and analysis carry out in `PPBstats`."}
knitr::include_graphics("figures/decision-tree-all-analysis-in-PPBstats.png")
```

## Let's go: install `PPBstats` !

To continue, load the current development version of the package [here](https://github.com/priviere/PPBstats/archive/v0.23.zip)

unzip the folder and then run 

```{r, eval=FALSE}
devtools::install("PPBstats-0.23")
```

Note that `JAGS` must be installed on your computer. See http://mcmc-jags.sourceforge.net/ for more details.

Then you can load the package :

```{r,warning=FALSE,message=FALSE}
library(PPBstats)
```

and download from internet the data used in this tutorial (this is useful to earn lots of time!) [here](https://github.com/priviere/PPBstats/releases/download/v0.20/data_PPBstats.zip).

The following examples have been performed with the following R version :
```{r}
unlist(sessionInfo()$R.version)
```


